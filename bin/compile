#!/usr/bin/env python
import os
import sys
from subprocess import call


def run_command(name, cmd):
    return call([cmd], shell=True)


def run_all(commands):
    for name, cmd in commands:
        print("Runnnig %s" % name)
        print(cmd)
        ret = run_command(name, cmd)
        print("-" * 80)

        if ret != 0:
            return False

    return True


if __name__ == '__main__':
    commands, project_root, file_path, positions = sys.argv[1:]
    commands = map(lambda s: s.strip(), commands.split(','))

    options = [
        ('pep8', 'pep8 --config=%s.pep8 %s' % (project_root, project_root)),
        ('nosetests', 'nosetests %s' % (file_path)),
        ('nosetests-project', 'nosetests %s' % (project_root)),
    ]

    run_all([
        (name, cmd) for name, cmd in options if name in commands
    ])
